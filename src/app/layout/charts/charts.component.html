<app-page-header [heading]="'Analytics'" [icon]="'fa-bar-chart-o'"></app-page-header> 
<div *ngFor="let kpi of kpis">
<h4>KPI: {{kpi.kpi_name}}</h4>
<div *ngFor="let chart of kpi.versions; let i = index;">
    <!-- {{(i%2===1)?'row':'null'}} -->
    <!-- <div ngClass="(i%2===0)?'row':null"> -->
    <div class="col col-sm-12">
        <div class="card mb-3">
            <div class="card-header">
                Chart type: {{chart}} {{filter[kpi.kpi_name][kpi.kpi_name+'-'+chart]}}
            </div>
            <div> </div>
            <div class="card-block">
                <div class="breadcrumb">
                <li class="breadcrumb-item" *ngFor="let drill of drilldowns[kpi.kpi_name][kpi.kpi_name+'-'+chart]; let last = last">
                    <i>{{drill}}</i>    
                </li>
                </div>
                <form class="form-inline my-2 my-lg-0"  style="float: right">
                <md-select placeholder="Timeline" [(ngModel)]="selectedvalue" (ngModelChange)="selection($event,kpi.kpi_name+'-'+chart)" name="option">
                    <md-option *ngFor="let option of options" [value]="option">{{option.value}}</md-option>
                </md-select>
                <div *ngIf="selectedvalue && selectedvalue.id===1">
                    <md2-datepicker name="mon"
                      placeholder="Select {{selectedvalue.value | lowercase}}"
                      [(ngModel)]="mon"
                      [required]="true"
                      id='{{chart}}'
                      type="month"
                      startView="month"
                      format="MMM y"
                      touchUi = true
                      #monthControl="ngModel"
                      [id]="1"
                      (change)="update($event)"
                      ></md2-datepicker>
                </div>
                <div *ngIf="selectedvalue && selectedvalue.id===2">
                    <md2-datepicker name="sDate"
                      id='{{chart}}'
                      placeholder="Start date"
                      [(ngModel)]="sDate"
                      [required]="true"
                      type="date"
                      startView="month"
                      format="d MMMM yy"
                      touchUi = true
                      #sdateControl="ngModel"
                      (change)="setMaxDate()"></md2-datepicker>
                </div>
                <div *ngIf="selectedvalue && selectedvalue.id===2">
                    <md2-datepicker name="eDate"
                      id='{{chart}}'
                      placeholder="End date"
                      [(ngModel)]="eDate3"
                      [required]="true"
                      [min]="sDate"
                      [max]="_maxDate"
                      type="date"
                      touchUi = true
                      startView="month"
                      format="d MMMM yy"
                      #edateControl="ngModel"
                      (change)="getChart(kpi.kpi_name+'-'+chart)"></md2-datepicker>
                </div>
                <p-autoComplete [(ngModel)]="divisions" [suggestions]="filteredDivisions" (completeMethod)="filterDivisions($event)" styleClass="wid100" [minLength]="1" placeholder="Filter" [multiple]="true" field="name" name="divisions">
                <ng-template let-brand pTemplate="item">
                <div class="ui-helper-clearfix" style="border-bottom:1px solid #D5D5D5">
                 <div style="font-size:18px;float:left;margin:10px 10px 0 0">{{brand.name}}</div>
                 <div style="font-size:18px;float:right;margin:10px 10px 0 0">{{brand.type}}</div>
                 </div>
                </ng-template>
                </p-autoComplete>
            </form>
             <!--  <ul>
                <li *ngFor="let d of divisions">{{d.name}}</li>
              </ul> -->
                <div id="{{kpi.kpi_name+'-'+chart}}"></div>
            </div>
            <div class="card-footer">
                <button class="btn btn-info btn-sm" (click)="getChart(kpi.kpi_name+'-'+chart)">Refresh</button>
            </div>
        </div>
    </div>
    <!-- </div> -->
</div>